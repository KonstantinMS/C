# Конспект по C

## Особенности синтаксиса

### Особенности переменных

```с
char            // символьный и целочисленный тип
unsigned char   // беззнаковый
signed char     // знаковый (появился в ANSI C90)
```

Остальные целочисленные по умолчанию знаковые — short, int, long, long long
Вещественных беззнаковых не бывает

```с
unsigned double   // CE
```

### Операция присваивания

Под копотом происходти операция копирования
левый операнд = правый операнд

```c
var = 100;
```

var — Модифицируемое лево-допустимое (l-value)
100 — числовой литерал

```c
int var, size;
var = size = 100;
```

### Операция инициализации

```c
int var = 100;
```

### scanf

Возвращает число прочитанных элементов из потока stdin
К пробельным символам относят пробел, табуляцию, перевод строки:

```c
int cnt = scanf("%c %c", &byte1, &byte2);
```

#### Чтение double

```c
double d;
int cnt = scanf("%lf", &d);
```

```c
int a; short b; float c; double d;
int cnt = scanf("%d %hd %f %lf", &a, &b, &c, &d);
printf("%d %hd %.2f %.2f", a, b, c, d);
```

#### Проверка на число аргументов

```c
if (scanf("%d", &item != 1) {
    printf("Error input");
}
```

### printf

printf == print formatted

#### Таблица команд форматирования функции printf


|Код| Формат|
| - |:-------------:|
|%с |	Символ типа char|
|%d |	Десятичное число целого типа со знаком||
|%i |	Десятичное число целого типа со знаком|
|%е |	Научная нотация (е нижнего регистра)|
|%Е |	Научная нотация (Е верхнего регистра)|
|%f |	Десятичное число с плавающей точкой|
|%g |	Использует код %е или %f — тот из них, который короче (при использовании %g используется е нижнего регистра)|
|%G |	Использует код %Е или %f — тот из них, который короче (при использовании %G используется Е верхнего регистра)|
|%о |	Восьмеричное целое число без знака|
|%s |	Строка символов|
|%u |	Десятичное число целого типа без знака|
|%х |	Шестнадцатиричное целое число без знака (буквы нижнего регистра)|
|%Х | Шестнадцатиричное целое число без знака (буквы верхнего регистра)|
|%р |	Выводит на экран значение указателя|
|%n |	Ассоциированный аргумент — это указатель на переменную целого типа, в которую помещено количество символов, записанных на данный момент|
|%%	| Выводит символ %|

#### Таблица модификаторов типов printf

TODO: add

#### Вывод времени hh:mm:ss

```c
unsigned char h = 11, m = 8, s = 1;
printf("%02d:%02d:%02d", h, m, s);
// 11:08:01
```

#### Вывод символа в текущей кодировке

```c
char ch = 'M';
printf("symbol: %c now code: %d", ch, ch);
```

### Этапы трансляции программы в машинный код.

q: Что называют модулем в проекте программы на языке Си?
a: Каждый отдельный файл с текстом программы

q: Какую роль играет текстовый препроцессор при компиляции программы на языке Си?
a: Обрабатывает директивы препроцессора в исходных файлах текстов программы

q: Какую роль играет непосредственно компилятор при транслировании программы на языке Си в машинный код?
a: Отдельные файлы с текстами программы преобразует в машинный код, формируя объектные файлы

q: Какую роль играет линкер (редактор связей) при компиляции программы на языке Си?
a: Соединяет между собой объектные файлы, формируя единую программу, добавляет код запуска и коды используемых библиотечных функций

## Особенности вычисления

### При целочисленном делении дробная часть отбрасывается

```c
#include <stdio.h>
int main(void)
{
    printf("%d", 9/2);      // 4
    printf("%d", -9/2);     // -4
    return 0;
}
```

В сравнении с питоном:

```python
print (9//2)    # 4
print (-9//2)   # -5
```

### Остаток от деления

#### Работает только с целыми

```c
int var = 10 % 3      // Ok
double var = 10. % 3  // CE
```

#### Учитывается только знак делимого

```c
int res_1 = 10 % 4;     // 2
int res_1 = -10 % 4;    // -2
int res_1 = -10 % -4;   // -2
int res_1 = 10 % -4;    // 2
```

#### Вычисление остатка без деления без использования %

```c
int res = 10 - 10 / 3 * 3;
```

### Инкремент

```c
// Ok
d++;
++(b);
```

#### Error: lvalue required as increment operand

```c
10++;    // применен к числовому литералу
(b++)++;   // значение в скобках становится числом 
(d + 10)++;
```

#### Нельзя использовать инкрементируемое выражение два раза в одной формуле

Это приведет к ошибках вычисления в различных компиляторах. warning: [-Wunsequenced]
Так можно

```c
int size = 10, w = 8;
int res = size++ * w + 20;
// 100
```

Так нет

```c
int size = 10;
int res = (size - 1) * 5 + (++size - 1) * 2;
// warning: unsequenced modification and access to 'size' [-Wunsequenced]
```

### Арифметические операции +=, -=, *=, /=, %=

Сначала выполняются все действия справа от равно, потом слева.

```c
// Ok
int b = 1;
res = (b *= 5) - 10;
res %= (b -= 1) * 5;
printf("%d", (a *= 3) * (b -= 10)); // скобки обязательно
// CE
int res += 10 / 2;  // ошибка именно в int
```

### Булевы величины

true — любое не нулевое
false — 0

#### с99

_Bool var = 0;
размер — минимальное допустимое целочисленное значение
_Bool var = 10; // приведется к 1
Для использования bool:

```c
#include <stdbool.h>
bool b = true;
```

#### Операции сравнения

с == использовать только целые числа

- Проверка слева на право
- Лишние вычисления не делаются

```
bool div_enable = x != 0 && 10 / x > 1;  // при x = 0, дальше не проверяется
```

## Операторы ветвления

### Условная тернарная операция

Всегда возвращает определенный результат
Операция может быть частью выражения или аргументом функции
max = a > b ? a : b;
Приоритет ? : ниже всего, кроме присваивания

```c
max = (a > b) ? (a > c ? a : c) : (b > c) ? b : c;
// скобки вложенной тернарной операции обязательные из-за низкого приоритета по сравнению со сравнением
```

### Оператор switch

- Внутри switch может быть любая конструкция, возвращающая целочисленное значение.
- После ключевого слова case должны быть прописаны целочисленные, **вычисляемые на этапе компиляции программы** === целочисленная метка времени компиляции программы
- Операторы после case могут отсутствовать.
- После срабанывания case будут выведены все последующие значения, если не было break
- default в си не обязательный. Вместо default можно использовать return 0.
- Метки case просматриваются строго сверху-вниз

#### Рекомендации

В реальной практике он нередко разрастается до больших размеров и затрудняет восприятие текста программы. Поэтому есть несколько рекомендаций, которых следует придерживаться при использовании оператора switch:

- оператор switch лучше выносить в отдельную функцию и прерывать его работы с помощью оператора return;
- программу следует организовывать так, чтобы после каждой метки case прописывался вызов некоторой функции вместо набора операторов;
- никогда в программах не используйте вложенные операторы switch.

# todo

- наисать прогу для вывода места, занимаемого всеми типами данных
-

# Поменять местами 2 переменные без использования третьей

```c
#include <stdio.h>
int main(void)
{
    unsigned char a = 3, b = 9;
    printf("before: %d %d\n", a, b);
    a = a ^ b;
    b = b ^ a;
    a = a ^ b;
    printf("after: %d %d\n", a, b);
    return 0;
}
```
